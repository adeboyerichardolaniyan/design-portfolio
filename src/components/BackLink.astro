---
interface Props {
  href: string;
  label: string;
}

const { href, label } = Astro.props;
---

<nav class="mx-auto max-w-[var(--content-max-width)] px-[var(--content-padding)] pt-[var(--space-md)]">
  <a
    href={href}
    data-back-link
    class="inline-flex items-center gap-1.5 text-[var(--font-size-caption)]"
    style="color: var(--color-text-secondary);"
  >
    <svg width="14" height="14" viewBox="0 0 14 14" fill="none" aria-hidden="true">
      <path d="M10.5 3.5L3.5 10.5M3.5 10.5H8.5M3.5 10.5V5.5" stroke="var(--color-text-tertiary)" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" />
    </svg>
    {label}
  </a>
</nav>

<script>
  function initBackLinks() {
    document.querySelectorAll("[data-back-link]").forEach((link) => {
      link.addEventListener("click", (event) => {
        var isProjectDetail = window.location.pathname.startsWith("/projects/");
        var canReturn = false;

        try {
          var ref = document.referrer ? new URL(document.referrer) : null;
          canReturn =
            isProjectDetail &&
            window.history.length > 1 &&
            !!ref &&
            ref.origin === window.location.origin;
        } catch (err) {
          canReturn = false;
        }

        if (!canReturn) return;

        event.preventDefault();
        try {
          sessionStorage.setItem("returningFromProject", "1");
        } catch (err) {}
        history.back();
      });
    });
  }

  initBackLinks();
  document.addEventListener("astro:page-load", initBackLinks);
</script>
