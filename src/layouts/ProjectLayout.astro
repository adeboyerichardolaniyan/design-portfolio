---
import Base from "./Base.astro";
import ProjectHero from "@/components/ProjectHero.astro";
import ProjectMeta from "@/components/ProjectMeta.astro";

interface Props {
  slug: string;
  frontmatter: {
    title: string;
    subtitle: string;
    category: string;
    description: string;
    role: string;
    tools: string[];
    duration: string;
    collaborators?: string[];
    coverImage: string;
    color?: string;
    links?: { label: string; url: string }[];
  };
}

const { slug, frontmatter } = Astro.props;
---

<Base title={`${frontmatter.title} â€” Portfolio`} description={frontmatter.subtitle}>
  <article class="mx-auto max-w-[var(--content-max-width)] px-[var(--content-padding)]">
    <!-- Hero Image -->
    <div class="pt-[var(--space-lg)]">
      <ProjectHero
        src={frontmatter.coverImage}
        alt={frontmatter.title}
        transitionName={`project-cover-${slug}`}
      />
    </div>

    <!-- Project Header + Description -->
    <div class="grid grid-cols-1 gap-x-[var(--space-lg)] gap-y-[var(--space-md)] pt-[var(--space-lg)] lg:grid-cols-[1fr_2fr]">
      <div>
        <h1
          class="text-[var(--font-size-heading)] font-[var(--font-weight-bold)] leading-[var(--line-height-tight)] text-[var(--color-text-primary)]"
          transition:name={`project-title-${slug}`}
        >
          {frontmatter.title}
        </h1>
        <p class="mt-[var(--space-xs)] text-[var(--font-size-caption)] uppercase tracking-widest text-[var(--color-text-tertiary)]">
          {frontmatter.category}
        </p>
      </div>

      <div>
        <p class="text-[var(--font-size-body)] leading-[var(--line-height-body)] text-[var(--color-text-primary)]">
          {frontmatter.description}
        </p>
      </div>
    </div>

    <!-- Metadata Grid -->
    <div class="mt-[var(--space-lg)]">
      <ProjectMeta
        role={frontmatter.role}
        collaborators={frontmatter.collaborators}
        duration={frontmatter.duration}
        tools={frontmatter.tools}
      />
    </div>

    <!-- External Links -->
    {frontmatter.links && frontmatter.links.length > 0 && (
      <div class="mt-[var(--space-lg)] grid grid-cols-1 gap-[var(--space-sm)] sm:grid-cols-2">
        {frontmatter.links.map((link) => (
          <a
            href={link.url}
            target="_blank"
            rel="noopener noreferrer"
            class="flex items-center justify-between rounded-[var(--radius-portfolio-md)] border border-[var(--color-border-custom)] px-6 py-4 text-[var(--font-size-caption)] uppercase tracking-widest text-[var(--color-text-primary)] transition-colors duration-[var(--duration-fast)] hover:bg-[var(--color-bg-secondary)]"
          >
            <span>{link.label}</span>
            <span>&rsaquo;</span>
          </a>
        ))}
      </div>
    )}

    <!-- MDX Content -->
    <div class="prose-portfolio mt-[var(--space-xl)] pb-[var(--space-xl)]">
      <slot />
    </div>
  </article>
</Base>

<style>
  .prose-portfolio :global(h2) {
    font-size: var(--font-size-heading);
    font-weight: var(--font-weight-bold);
    line-height: var(--line-height-tight);
    color: var(--color-text-primary);
    margin-top: var(--space-lg);
    margin-bottom: var(--space-sm);
  }
  .prose-portfolio :global(h3) {
    font-size: 1.25rem;
    font-weight: var(--font-weight-bold);
    line-height: var(--line-height-tight);
    color: var(--color-text-primary);
    margin-top: var(--space-md);
    margin-bottom: var(--space-xs);
  }
  .prose-portfolio :global(p) {
    font-size: var(--font-size-body);
    line-height: var(--line-height-body);
    color: var(--color-text-primary);
    margin-bottom: var(--space-sm);
  }
  .prose-portfolio :global(img) {
    width: 100%;
    border-radius: var(--radius-portfolio-lg);
    margin-top: var(--space-md);
    margin-bottom: var(--space-md);
  }
  .prose-portfolio :global(ul),
  .prose-portfolio :global(ol) {
    padding-left: 1.5em;
    margin-bottom: var(--space-sm);
  }
  .prose-portfolio :global(li) {
    margin-bottom: var(--space-xs);
  }
  .prose-portfolio :global(a) {
    text-decoration: underline;
    text-underline-offset: 2px;
  }
  .prose-portfolio :global(blockquote) {
    border-left: 3px solid var(--color-border-custom);
    padding-left: var(--space-sm);
    color: var(--color-text-secondary);
    font-style: italic;
  }
</style>
